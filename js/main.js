function rebuild_orderbook_trade_list(e){g_last_fiat=g_fiat,g_fiat=e;var t=trade_global.symbol.split("_"),a=t[0].toUpperCase(),i=t[1].toUpperCase();if(change_fiat_tags(e,a,i),g_ask_list){var l=build_order_table(g_ask_list,1,32);""!=l&&(get_element("ul-ask-list").innerHTML=l)}if(g_bid_list){var r=build_order_table(g_bid_list,0,32);""!=r&&(get_element("ul-bid-list").innerHTML=r)}if(g_trade_list){var _=build_trade_history_table(g_trade_list);""!=_&&(get_element("ul-trade-list").innerHTML=_)}var s=1,n=$("#ask_rate").val(),d=$("#bid_rate").val(),o=.5*(parseFloat($("#ul-ask-list li").eq(0).find(".price").html())+parseFloat($("#ul-bid-list li").eq(0).find(".price").html()));parseFloat(n),parseFloat(d);0==o&&(o=1e-7),g_last_fiat==g_fiat?($("#ask_rate").val($("#ul-ask-list li").eq(0).find(".price").html()),$("#bid_rate").val($("#ul-bid-list li").eq(0).find(".price").html())):("BTC"==i?s=global_btc_cny_rate:"ETH"==i?s=global_eth_cny_rate:"USDT"==i?s=global_usdt_cny_rate:"QTUM"==i&&(s=global_qtum_cny_rate),"USD"!=g_fiat&&"USD"!=g_last_fiat||(s/=6.6),""==g_fiat?(n/=s,d/=s):(n*=s,d*=s),rate_decimals=n>=10?2:n>=1?3:n>=.1?4:n>=.01?5:n>=.001?6:7,n=n.toFixed(rate_decimals),d=d.toFixed(rate_decimals),$("#ask_rate").val(n),$("#bid_rate").val(d)),_page.obj.on_input_bid_rate(),_page.obj.recalc_fee("bid"),_page.obj.on_input_ask_rate(),_page.obj.recalc_fee("ask")}function build_trade_history_table(e){var t=1;e.length>0&&(t=e[0][1]);var a=1,i=3,l=trade_global.symbol.split("_"),r=(l[0].toUpperCase(),l[1].toUpperCase());"BTC"==r?a=global_btc_cny_rate:"ETH"==r?a=global_eth_cny_rate:"USDT"==r?a=global_usdt_cny_rate:"QTUM"==r&&(a=global_qtum_cny_rate),"USD"==g_fiat?a/=6.6:""==g_fiat&&(a=1);var _=t*a;i=_>=10?2:_>=1?3:_>=.1?4:_>=.01?5:_>=.001?6:7;for(var s="",n=0;n<e.length;n++){var d=e[n];if(!(d.length<7)){var o;o=n%2==1?"odd hanga":"even hangb";var c;c="sell"==d[5]?"number down "+o:"number up "+o;var g=new Date(1e3*d[4]),f=g.getHours(),p="0"+g.getMinutes(),m="0"+g.getSeconds(),b=f+":"+p.substr(-2)+":"+m.substr(-2),u=d[2],h=d[3],v=d[1];""!=g_fiat&&(v*=a,h=(h*=a).toFixed(2),v=v.toFixed(i)),s+='<li data-id="list-item" tid="'+d[6]+'" class="'+c+'">',s+='<span class="time" data-id="time">'+b+"</span>",s+='<span class="price" data-id="price">'+v+"</span>",s+='<span class="amount" data-id="amount">'+u+"</span>",s+='<span class="total" data-id="total">'+h+"</span>",s+="</li>"}}return s}function get_bid_or_ask_decimals(e,t,a){var i=t||"",a=a||!1;""==i&&(i=trade_global.symbol.split("_")[1].toUpperCase());var l=e,r=1,_=typeof l;"object"==_&&l.length>0&&(r=l[0][0]),"string"!=_&&"number"!=_||(r=l);var s=1,n=3;if("BTC"==i){s=global_btc_cny_rate;d="฿"}else if("ETH"==i){s=global_eth_cny_rate;d="E"}else if("USDT"==i){s=global_usdt_cny_rate;d="$"}else if("QTUM"==i){s=global_qtum_cny_rate;var d="Q"}a?"en"==g_lang&&(s/=6.6):"USD"==g_fiat?s/=6.6:""==g_fiat&&(s=1);var o=r*s;return n=o>=10?2:o>=1?3:o>=.1?4:o>=.01?5:o>=.001?6:7,{unitSymbol:d,fiat_rate_decimals:n,fiat_rate:s}}function get_orderbook_vol_sum(e,t,a,i,l){var r=0;l<=0&&(l=1e-8);for(var _=0;_<e.length&&!(_>a);_++){e[_];r+=t?parseFloat(e[_][1]):parseFloat(e[_][2])}return t?i||(r*=l):i&&(r/=l),r}function get_ask_bid_list_vol_sum(e,t,a){var i=0,l=0;return g_ask_list&&(i=get_orderbook_vol_sum(g_ask_list,1,e,t,a)),g_bid_list&&(l=get_orderbook_vol_sum(g_bid_list,0,e,t,a)),l>i?l:i}function build_order_table(e,t,a){var i=get_bid_or_ask_decimals(e),l=i.fiat_rate,r=i.fiat_rate_decimals;o=t?1:0;for(var _=0,s=0,n=0;n<e.length&&!(n>a);n++){m={},e[n];t?_<parseFloat(e[n][1])&&(_=parseFloat(e[n][1])):_<parseFloat(e[n][2])&&(_=parseFloat(e[n][2]))}s=get_ask_bid_list_vol_sum(a,t,parseFloat(e[0][0]));for(var d,o,c="",g=0,f=0,p=0,n=0;n<e.length;n++){var m=e[n];if(++p>a)break;d=p%2==1?"odd hanga":"even hangb",g+=parseFloat(m[1]),f+=parseFloat(m[2]),rate=m[0];var b=m[1],u=m[2],h=m[0],k=f;""!=g_fiat&&(u*=l,h*=l,k=(k*=l).toFixed(2),u=u.toFixed(2),h=h.toFixed(r)),v=t?g:f;var $=Math.pow(v,.5)/Math.pow(s,.5)*55;if($<1&&($=1),!(m.rate<=0||m.symbol_l<=0||m.symbol_r<=0)){var y="onclick='set_price("+o.toString()+","+h+","+g+","+k+")'";m.mine?c+="<li  "+y+" class='orderline orderline_mine "+d+"'> ":c+="<li  "+y+" class='orderline "+d+"'> ",c+=t?'\t\t<span data-id= "price"  class= "price right-align" >'+h+'</span>   <span data-id= "volume" class= "volume right-align"  >'+b+'</span>  <span data-id= "total" class= "right-align total" >'+u+'</span>  <span data-id= "rect" class= "right-align rect down orange" style="width: '+$+'px;"></span> ':'<span data-id= "price"  class= "price right-align" >'+h+'</span>  <span data-id= "volume" class= "right-align volume"  >'+b+'</span>   <span data-id= "total" class= "right-align total" >'+u+'</span>   <span data-id= "rect" class= "right-align rect down fenlv" style="width: '+$+'px;"></span>',c+="</li>"}}return c}function latest_price_ischange(e,t,a){var i=a||g_ask_list;if(!i&&!(i=g_bid_list))return!1;var l=get_bid_or_ask_decimals(i),r=l.fiat_rate,_=l.fiat_rate_decimals,s=get_element("orderbook_last_rate");"string"==typeof e&&(e=parseFloat(e));var n=e*r;return s.innerHTML=n.toFixed(_),e!=t&&(s.className=e>t?"red":"green"),!0}function change_fiat_tags(e,t,a){var i=""==e?a.toUpperCase():e.toUpperCase(),l="cn"==g_lang?"卖出价":"Price",r="cn"==g_lang?"总计":"Total",_="cn"==g_lang?"成交价":"Deal Price";$("#tableAskList li").find("span").eq(0).find("b").eq(0).html(l+"("+i+")"),$("#tableAskList li").find("span").eq(2).find("b").eq(0).html(r+"("+i+")"),$("#deal-info-box li").find("span").eq(1).html(_+"("+i+")"),$("#deal-info-box li").find("span").eq(3).html(r+"("+i+")");var s="cn"==g_lang?"兑换额 "+a:"Total "+a;if(""==e)get_element("orderbook_last_rate").innerHTML=g_latest_price,$(".ask-bid-price").find("span").html(a+"/"+t),$("#orderUnitSymbol").show(),$("#cnySymbol").hide(),s="cn"==g_lang?"兑换额 "+a:"Total "+a;else{var n=get_element("orderbook_last_rate").innerHTML;latest_price_ischange(n,n),$(".ask-bid-price").find("span").html('<span class="red">'+e+"</span>/"+t),$("#orderUnitSymbol").hide(),$("#cnySymbol").show(),s="cn"==g_lang?'兑换额 <span class="red">'+e+"</span>":'Total <span class="red">'+e+"</span>"}$("#ask_total_label").html(s),$("#bid_total_label").html(s),build_left_side(e,a)}function build_left_side(e,t){var a=["btc","eth","usdt","new"];if(""!=(e=e||g_fiat))for(var i in a){g_left_side_price[a[i]]=[];for(var l=[],r=$("#marketlist_"+a[i]+" tr"),_=1;_<r.length;_++){var s=r.eq(_).attr("id"),n=r.eq(_).find("td").eq(1).find("span").html();l[s]=n;var d=r.eq(_).find("td").eq(1).find("span").find("i"),o=parseFloat(n),c=get_bid_or_ask_decimals(o,(t="new"==a[i]?s.split("_")[2]:a[i]).toUpperCase()),g=c.fiat_rate_decimals;o*=c.fiat_rate,r.eq(_).find("td").eq(1).find("span").html(o.toFixed(g)),r.eq(_).find("td").eq(1).find("span").append(d)}f="cn"==g_lang?"价格":"Price";$("#marketlist_btc").find("th").eq(1).html(f+"("+e+")"),$("#marketlist_eth").find("th").eq(1).html(f+"("+e+")"),$("#marketlist_usdt").find("th").eq(1).html(f+"("+e+")"),$("#marketlist_new").find("th").eq(1).html(f+"("+e+")"),g_left_side_price[a[i]]=l}else{if(void 0===g_left_side_price.btc)return;for(var i in a)if(g_left_side_price[a[i]])for(var l=g_left_side_price[a[i]],r=$("#marketlist_"+a[i]+" tr"),_=0;_<r.length;_++){s=r.eq(_).attr("id");r.eq(_).find("td").eq(1).find("span").html(l[s])}var f="cn"==g_lang?"价格":"Price";$("#marketlist_btc").find("th").eq(1).html(f+"(BTC)"),$("#marketlist_eth").find("th").eq(1).html(f+"(ETH)"),$("#marketlist_usdt").find("th").eq(1).html(f+"(USDT)"),$("#marketlist_new").find("th").eq(1).html(f)}}function update_top_price(e){var t=trade_global.symbol,a=t.split("_"),i=(a[0],a[1]),l=decimal_for_KLine,r=+parseFloat(e).toFixed(l),_=get_element("currPrice"),s=0,n=(s=_?+parseFloat(_.innerHTML):e).toFixed(l);if($.isNumeric(e)&&e>0&&(g_latest_price=r,n!=r)){var d=i.toLowerCase(),o=("market_"+t+"_"+d).toLowerCase();if(void 0===get_element(o)&&(o="market_"+t+"_new"),void 0===get_element(o))return!1;var c="";if(c=g_left_side_price[d]&&g_left_side_price[d][o]?g_left_side_price[d][o]:$("#"+o+" span").eq(2).html(),c.substr(0,c.indexOf("<")-1)==r){var g=$(".coin-selected font").eq(0).html();if(g.indexOf("+")>-1&&g.indexOf("-")>-1)var f=g.replace(/-/,""),p=+f.substr(1,f.length-2);else{p=+g.substr(1,g.length-2);g.indexOf("-")>-1&&(p=-p)}v=p}else{var m="",b=get_element("top_last_rate_change").getElementsByTagName("font")[0].innerHTML;if(b.indexOf("+")>-1&&b.indexOf("-")>-1){var u=b.replace(/-/,"");m=+u.substr(1,u.length-2)}else m=+b.substr(1,b.length-2),b.indexOf("-")>-1&&(m=-m);var h=parseFloat(100*s/(100+m)),v=(e-h)/h*100}if(!isNaN(v)){var k=get_bid_or_ask_decimals(e,i,!0),y=k.unitSymbol,F=document.title;F=F.substr(F.indexOf(" ")+1),document.title=y+e.toFixed(l)+" "+F;var T=(e*k.fiat_rate).toFixed(k.fiat_rate_decimals),q=get_element("orderbook_last_rate");if(g_fiat){var w=get_bid_or_ask_decimals(e,i);q.innerHTML=(e*w.fiat_rate).toFixed(w.fiat_rate_decimals)}else q.innerHTML=r;if("cn"==g_lang)get_element("top_last_rate_change").innerHTML='<dl class="price-dl"><dd><em>'+y+'</em><i id="currPrice">'+r+'</i><small> 或 </small><i id="currFiat"><em>￥</em>'+T+"</i></dd></dl><dl><dd><em><font color="+(v>=0?"#de5959":"#008069")+">"+(v>=0?"+":"")+v.toFixed(2)+'%</font></em><span class=arr-con><i class="caret" id="upArrow"></i><i class="caret" id="dnArrow"></i></span></dd></dl>';else{var x="";"USDT"!==i&&(x='<small> Or </small><em>$</em><i id="currFiat">'+T+"</i>"),get_element("top_last_rate_change").innerHTML="<i id=currPrice>"+r+"</i>"+x+"<em><font color="+(v>=0?"#008069":"#de5959")+">"+(v>=0?"+":"")+v.toFixed(2)+'%</font></em><span class=arr-con><i class="caret" id="upArrow"></i><i class="caret" id="dnArrow"></i></span>'}if(r>n){if(get_element("top_last_rate_change").className="xiaoguoup",$("#upArrow").stop().animate({bottom:"10px"},2e3,function(){$(this).attr("style","")}).show(),$("#currFiat").length>0)L=$("#currPrice,#currFiat");else L=$("#currPrice");L.stop().animate({color:"cn"==g_lang?"#de5959":"#008069"},1500,function(){$(this).attr("style","")})}else if(r<n){if(get_element("top_last_rate_change").className="xiaoguodown",$("#dnArrow").stop().animate({top:"25px"},2e3,function(){$(this).attr("style","")}).show(),$("#currFiat").length>0)L=$("#currPrice,#currFiat");else var L=$("#currPrice");L.stop().animate({color:"cn"==g_lang?"#008069":"#de5959"},1500,function(){$(this).attr("style","")})}s=null,l=null,v=null,T=null,r=null,n=null}}}var g_ask_list=null,g_bid_list=null,g_trade_list=null,g_fiat="",g_last_fiat="",g_latest_price=get_element("orderbook_last_rate").innerHTML,g_left_side_price=[];$(function(){function e(e){var t=e.data;if(t&&t.result){t.bid_rate0<=0&&(t.bid_rate0=t.ask_rate0),t.ask_rate0<=0&&(t.ask_rate0=t.bid_rate0),t.bid_rate0=t.bid_rate0>0?t.bid_rate0:t.ask_rate0?t.ask_rate0:0,t.ask_rate0=t.ask_rate0>0?t.ask_rate0:t.bid_rate0?t.bid_rate0:0;var a=(t.bid_rate0+t.ask_rate0)/2;if(t.bid_rate0>0&&t.ask_rate0>0&&(update_top_price(a),a=null),t.ask_list){g_ask_list=t.ask_list;var i=build_order_table(t.ask_list,1,32);""!=i&&(get_element("ul-ask-list").innerHTML=i)}if(t.bid_list){g_bid_list=t.bid_list;var l=build_order_table(t.bid_list,0,32);""!=l&&(get_element("ul-bid-list").innerHTML=l)}if(t.trade_list){g_trade_list=t.trade_list;var r=build_trade_history_table(t.trade_list);""!=r&&(get_element("ul-trade-list").innerHTML=r)}Object.keys(t.market_rates).length>0&&get_Price_Percent(t.market_rates),t=null}$("#ot2").hasClass("order-t-active")?checkEmpty(2):checkEmpty(0)}void 0===window.get_element&&(window.get_element=function(e,t){return null==t&&(t=0),obj=document.getElementById(e),obj||(obj=document.getElementsByName(e),obj?obj[t]:null)}),g_ask_list=datas_asks,g_bid_list=datas_bids,g_trade_list=datas_trades;rebuild_orderbook_trade_list("");var t="gateio_"+trade_global.symbol.toLowerCase(),a=io("https://ws.gate.io");a.on("trade_data",function(t){e(t),t=null}),a.on("disconnect",function(){}),a.on("connect",function(){a.emit("join",t)}),a.on("reconnect",function(){a.emit("join",t)}),a.on("reconnect_error",function(){})});